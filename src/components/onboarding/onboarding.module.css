.page {
    /* 4000ms */
    --animation-duration: 2000ms;
    background-color: var(--color-main-purple);
    position: fixed;
    inset: 0;
    z-index: var(--z-index-max);
    padding-block: 16px;
}

.step {
    --max-height-for-canvas: 452;
    max-width: 390px;
    margin-inline: auto;
    height: calc(100% - 238px);
    position: relative;
}

.defi {
    position: absolute;
    top: 50%;
    left: 50%;
    translate: -50% -50%;
    transition: all 1.5s ease-in-out;
    z-index: 2;

    animation-duration: var(--animation-duration);
    animation-fill-mode: forwards;
    animation-timing-function: cubic-bezier(0.42, 0, 0.58, 1);
    animation-name: zoomInOut;
}
@keyframes zoomInOut {
    0% {
        scale: 0;
    }
    20% {
        scale: 0.8;
    }
    100% {
        scale: 1;
    }
}

.ton1 {
    --width: 82px;
    --height: 89px;
    --position-top: 51;
    --position-top-percent: calc((var(--position-top) * 100) / var(--max-height-for-canvas) * 1%);
    width: var(--width);
    height: var(--height);
    position: absolute;
    left: 66px;
    bottom: -100%;

    animation-duration: var(--animation-duration);
    animation-fill-mode: forwards;
    animation-timing-function: cubic-bezier(0.4, 1.22, 0.97, 1.01);
    animation-name: rotateAndSlideUp;
}
@keyframes rotateAndSlideUp {
    0% {
        bottom: -100%;
        opacity: 0;
    }
    100% {
        bottom: calc(100% - var(--position-top-percent) - var(--height));
        transform: rotateZ(360deg);
        opacity: 1;
    }
}

.ton2 {
    --width: 63px;
    --height: 62px;
    --position-top: 164;
    --position-top-percent: calc((var(--position-top) * 100) / var(--max-height-for-canvas) * 1%);
    width: var(--width);
    height: var(--height);
    position: absolute;
    left: 301px;
    bottom: -100%;

    animation-duration: calc(var(--animation-duration) + 300ms);
    animation-fill-mode: forwards;
    animation-timing-function: cubic-bezier(0.4, 1.22, 0.97, 1.01);
    animation-name: rotateAndSlideUp2;
}
@keyframes rotateAndSlideUp2 {
    0% {
        bottom: -100%;
        opacity: 0;
    }
    100% {
        bottom: calc(100% - var(--position-top-percent) - var(--height));
        transform: rotateX(360deg);
        opacity: 1;
    }
}

.ton3 {
    --width: 65px;
    --height: 60px;
    --position-top: 323;
    --position-top-percent: calc((var(--position-top) * 100) / var(--max-height-for-canvas) * 1%);
    width: var(--width);
    height: var(--height);
    position: absolute;
    left: 90px;
    bottom: -100%;

    animation-duration: calc(var(--animation-duration) + 600ms);
    animation-fill-mode: forwards;
    animation-timing-function: cubic-bezier(0.4, 1.22, 0.97, 1.01);
    animation-name: rotateAndSlideUp3;
}
@keyframes rotateAndSlideUp3 {
    0% {
        bottom: -100%;
        transform: rotateY(360deg);
        opacity: 0;
    }
    100% {
        bottom: calc(100% - var(--position-top-percent) - var(--height));
        transform: rotateY(0);
        opacity: 1;
    }
}

.bubble1 {
    --width: 141px;
    --height: 134px;
    --position-top: 183;
    --position-top-percent: calc((var(--position-top) * 100) / var(--max-height-for-canvas) * 1%);
    width: var(--width);
    height: var(--height);
    position: absolute;
    left: -53px;
    bottom: -100%;
    z-index: 3;

    animation-duration: calc(var(--animation-duration) + 800ms);
    animation-fill-mode: forwards;
    animation-timing-function: cubic-bezier(0.12, 0.48, 0.97, 1.01);
    animation-name: bubbleUp;
}

@keyframes bubbleUp {
    0% {
        scale: 0.3;
    }
    50% {
        scale: 0.8;
    }
    100% {
        scale: 1;
        bottom: calc(100% - var(--position-top-percent) - var(--height));
    }
}

.bubble2 {
    --width: 88px;
    --height: 84px;
    --position-top: 112;
    --position-top-percent: calc((var(--position-top) * 100) / var(--max-height-for-canvas) * 1%);
    width: var(--width);
    height: var(--height);
    position: absolute;
    left: 223px;
    bottom: -100%;
    z-index: 1;

    animation-duration: calc(var(--animation-duration) + 900ms);
    animation-fill-mode: forwards;
    animation-timing-function: cubic-bezier(0.12, 0.48, 0.97, 1.01);
    animation-name: bubbleUp;
}

.bubble3 {
    --width: 200px;
    --height: 190px;
    --position-top: 229;
    --position-top-percent: calc((var(--position-top) * 100) / var(--max-height-for-canvas) * 1%);
    width: var(--width);
    height: var(--height);
    position: absolute;
    left: 264px;
    bottom: -100%;
    z-index: 3;

    animation-duration: calc(var(--animation-duration) + 1200ms);
    animation-fill-mode: forwards;
    animation-timing-function: cubic-bezier(0.12, 0.48, 0.97, 1.01);
    animation-name: bubbleUp;
}
